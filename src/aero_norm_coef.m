%% Mach 6
alpha = 0 : 20;

C_L_M6  = [0 0.002 0.005 0.006 0.009 0.011 0.014 0.016 0.019 0.021 ...
           0.023 0.026 0.028 0.032 0.034 0.036 0.0385 0.041 0.044 0.047 0.05];
      
f_CN6 = fit(transpose(alpha), transpose(C_L_M6),  'poly1');

alpha_test = 0 : 0.01 : 20;
C_test = f_CN6.p1 * alpha_test + f_CN6.p2;

figure();
plot(alpha, C_L_M6);
hold on;
plot(alpha_test, C_test);

%% Mach 10
alpha = 0 : 25;

C_L_M10 = [0 0.002 0.005 0.006 0.009 0.011 0.014 0.016 0.019 0.021 ...
           0.023 0.026 0.028 0.032 0.034 0.036 0.0385 0.042 0.045 0.048 0.053 ...
           0.056 0.06 0.063 0.068 0.075];
       
f_CN10 = fit(transpose(alpha), transpose(C_L_M10), 'poly1');

alpha_test = 0 : 0.01 : 20;
C_test = f_CN10.p1 * alpha_test + f_CN10.p2;
       
figure();
plot(alpha, C_L_M10);
hold on;
plot(alpha_test, C_test);

%% Other mach

% M = 0.4
alpha1 = -23 : -5;
M04 = [-0.04 -0.037 -0.033 -0.031 -0.028 -0.025 -0.023 -0.02 -0.018 ...
       -0.016 -0.014 -0.012 -0.011 -0.008 -0.006 -0.004 -0.003 -0.001 ...
       0 0 0 0  0.001 0.003];


f_CN_04_a_23_5 = fit(transpose(alpha1), transpose(M04(1:19)), 'poly2');
f_CN_04_a_1_0 = fit(transpose(-1:0), transpose(M04(23:24)), 'poly1');

%M = 0.6
alpha = -23 : 0
M06 = [-0.0425 -0.04 -0.0375 -0.035 -0.0325 -0.03 -0.02625 -0.0225 -0.02 -0.0175...
       -0.015 -0.01175 -0.01 -0.00825 -0.0065 -0.00475 -0.003 -0.00125 0 0 0 0 0 0.00125];
   
f_CN_06 = fit(transpose(alpha), transpose(M06), 'poly2');



%M = 0.8 and 0.9 (same curve)
M08 = [-0.04625 -0.04375 -0.04125 -0.03875 -0.03625 -0.03375 -0.03125 -0.0275 ...
       -0.025 -0.0225 -0.02 -0.01625 -0.01375 -0.01125 -0.01 -0.0075 -0.005 ...
       -0.00375 -0.0025 -0.00125 0 0.00125 0.0025 0.0025];

f_CN_08 = fit(transpose(alpha), transpose(M08), 'poly2')

%M = 1
alpha = -23 : 0
M1 = [-0.04625 -0.04375 -0.04125 -0.03875 -0.03625 -0.03375 -0.03125 -0.0275 ...
       -0.025 -0.0225 -0.02 -0.0175 -0.015 -0.0125 -0.01 -0.0075 -0.005 -0.0025 0 ...
       0.0025 0.005 0.006 0.004375 0.0025];

f_CN_1 = fit(transpose(alpha), transpose(M1), 'poly2');

%M = 1.2
M1_2 = [-0.04 -0.038 -0.036 -0.034 -0.033 -0.0315 -0.03 -0.0275 -0.025 -0.0225 ...
        -0.01875 -0.01625 -0.01375 -0.01125 -0.01 -0.008 -0.005 -0.002 0 0.002 0.005 ...
        0.0075 0.01 0.005];
    
f_CN_1_2 = fit(transpose(alpha), transpose(M1_2), 'poly2');

%M = 2
alpha = -7 : 0
M2 = [0.01 0.009 0.008 0.007 0.0055 0.0035 0.0015 0];

f_CN_2 = fit(transpose(alpha), transpose(M2), 'poly2');

addpath('Data');
save('Data\fit_areo_norm_coef', 'f_CN6', 'f_CN10', 'f_CN_04_a_23_5', 'f_CN_04_a_1_0', ...
    'f_CN_06', 'f_CN_08', 'f_CN_1', 'f_CN_1_2', 'f_CN_2');